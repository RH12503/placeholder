function place(){if(/bot|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent))for(var e=document.querySelectorAll("img[data-src]"),t=0;t<e.length;t++)e[t].src=e[t].dataset.src;else{e=document.querySelectorAll("img[data-src]");var n=function(){var n=e[t];switch(r="contain",window.getComputedStyle(n).objectFit){case"cover":r="cover";break;case"fill":r="100% 100%";break;case"none":r="auto"}n.style.backgroundPosition=window.getComputedStyle(n).objectPosition,n.style.backgroundSize=r,n.style.opacity="0",n.style.backgroundRepeat="no-repeat",n.style.transition="background 1s, background-position 0s, background-size 0s",a=new XMLHttpRequest;var o=n.dataset.src.replace(/\.[^/.]+$/,".tri");a.open("GET",o,!0),a.responseType="arraybuffer",a.onreadystatechange=function(e){var t=e.currentTarget.response;if(t){var r=new DataView(t),a=parseData(r),o=r.getUint16(0,!0),i=r.getUint16(2,!0),c=document.createElement("canvas");c.width=o,c.height=i;var g=c.toDataURL();renderData(c,a);var s=new XMLHttpRequest;s.open("GET",n.dataset.src,!0),s.responseType="blob",s.onreadystatechange=function(e){if(e.currentTarget.response){var t=new FileReader;t.onloadend=function(){n.style.backgroundImage="url(".concat(t.result,")"),n.ontransitionend=function(){n.src=t.result,n.onload=function(){n.style.backgroundImage=""}}},t.readAsDataURL(e.currentTarget.response)}},s.send(),n.src=g,n.style.backgroundImage="url('".concat(c.toDataURL("image/jpeg"),"')"),n.style.opacity="1"}},a.send()};for(t=0;t<e.length;t++){var r,a;n()}}}function renderData(e,t){var n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);for(var r=0;r<t.length;r++){var a=t[r].triangle,o=t[r].color,i="rgb(".concat(o[0],", ").concat(o[1],", ").concat(o[2],")");n.fillStyle=i,n.strokeStyle=i,n.lineWidth=1,n.beginPath(),n.moveTo(a[0][0],a[0][1]),n.lineTo(a[1][0],a[1][1]),n.lineTo(a[2][0],a[2][1]),n.closePath(),n.fill(),n.stroke()}}function parseData(e){var t=[];t.push({triangle:[[e.getUint16(5,!0),e.getUint16(7,!0)],[e.getUint16(9,!0),e.getUint16(11,!0)],[e.getUint16(13,!0),e.getUint16(15,!0)]],color:[e.getUint8(17,!0),e.getUint8(18,!0),e.getUint8(19,!0)],remaining:e.getUint8(4,!0)});for(var n=0,r=20;r<e.byteLength;){var a=t[n],o=e.getUint8(r,!0);r++;var i,c,g=o>>2&3,s=t[n].triangle;if(o>>4&1?(i=[a.triangle[g][0]+e.getInt8(r,!0),a.triangle[g][1]+e.getInt8(r+1,!0)],r+=2):(i=[e.getUint16(r,!0),e.getUint16(r+2,!0)],r+=4),o>>5&1){var l=e.getUint16(r,!0);c=[a.color[0]+(63&l)-32,a.color[1]+(l>>6&63)-32,a.color[2]+(l>>12&15|(o>>6&3)<<4)-32],r+=2}else c=[e.getUint8(r,!0),e.getUint8(r+1,!0),e.getUint8(r+2,!0)],r+=3;var d=[s[g],s[(g+1)%3],i].sort(function(e,t){return e[1]==t[1]?e[0]-t[0]:e[1]-t[1]});for(t.push({triangle:d,color:c,remaining:3&o}),t[n].remaining--;t[n]&&0==t[n].remaining;)n++}return t}window.addEventListener("DOMContentLoaded",place);